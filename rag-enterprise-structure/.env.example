# ==============================================================================
# RAG ENTERPRISE - Configuration Guide
# ==============================================================================
#
# IMPORTANT: Copy this file to `.env` before starting the system:
#   cp .env.example .env
#
# Then edit `.env` with your configuration and restart backend:
#   docker compose restart backend
#
# ==============================================================================

# ==============================================================================
# 1. FRONTEND API URL (REQUIRED)
# ==============================================================================
# This tells the frontend where to find the backend API.
# Choose ONE scenario and uncomment the appropriate line:

# ──────────────────────────────────────────────────────────────────────────────
# SCENARIO A: LOCALHOST (Development - Same Computer) - DEFAULT
# ──────────────────────────────────────────────────────────────────────────────
# Use this if accessing from the same computer where Docker runs.
# Frontend: http://localhost:3000
VITE_API_URL=http://localhost:8000

# ──────────────────────────────────────────────────────────────────────────────
# SCENARIO B: LOCAL NETWORK (LAN - Multiple Devices)
# ──────────────────────────────────────────────────────────────────────────────
# Use this to access from other devices on your local network.
# Replace 192.168.1.100 with your server's IP address.
# Find your IP: ip addr show | grep inet
#VITE_API_URL=http://192.168.1.100:8000

# ──────────────────────────────────────────────────────────────────────────────
# SCENARIO C: INTERNET (Production - Public Domain)
# ──────────────────────────────────────────────────────────────────────────────
# Use this for production with a domain and HTTPS.
# Requires: domain, reverse proxy (Nginx/Caddy), SSL certificate
# Example: VITE_API_URL=https://rag.yourdomain.com
#VITE_API_URL=https://rag.yourdomain.com

# ==============================================================================
# 2. PORTS (Optional - Use Defaults)
# ==============================================================================
# Only change these if you have port conflicts.
BACKEND_PORT=8000
FRONTEND_PORT=3000

# ==============================================================================
# 3. SECURITY CONFIGURATION (CRITICAL FOR PRODUCTION!)
# ==============================================================================
#
# ⚠️  WARNING: If not configured, the system uses INSECURE defaults:
#    - Default JWT secret key (anyone can forge authentication tokens!)
#    - CORS allows ALL domains (any website can access your API!)
#
# ✅  For PRODUCTION deployments, you MUST configure these:
#

# ──────────────────────────────────────────────────────────────────────────────
# JWT_SECRET_KEY - Protects Authentication
# ──────────────────────────────────────────────────────────────────────────────
# What it does:
#   - Signs JWT tokens used for user authentication
#   - Prevents attackers from creating fake login tokens
#   - Without a strong key, anyone can impersonate users (including admin!)
#
# How to set it:
#   1. Generate a secure random key:
#      openssl rand -hex 32
#
#   2. Copy the output and paste it below (remove the # to uncomment):
#
# JWT_SECRET_KEY=paste-your-generated-key-here
#
# Example (DO NOT USE THIS - generate your own!):
# JWT_SECRET_KEY=a3f8b2c9d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1

# ──────────────────────────────────────────────────────────────────────────────
# ADMIN_DEFAULT_PASSWORD - Initial Admin Account Password
# ──────────────────────────────────────────────────────────────────────────────
# What it does:
#   - Sets the password for the initial 'admin' account
#   - If not set, a RANDOM SECURE password is generated and shown in logs
#   - The password is only used when creating the admin account for the first time
#
# RECOMMENDED: Leave unset and copy the random password from the logs!
# This is more secure than having a known default password.
#
# If you prefer to set a specific password:
# ADMIN_DEFAULT_PASSWORD=your-secure-password-here

# ──────────────────────────────────────────────────────────────────────────────
# QDRANT_API_KEY - Vector Database Security (Optional)
# ──────────────────────────────────────────────────────────────────────────────
# What it does:
#   - Protects the Qdrant vector database from unauthorized access
#   - Recommended for production deployments
#   - If not set, Qdrant runs without authentication (OK for local development)
#
# How to set it:
#   1. Generate a secure key:
#      openssl rand -hex 32
#
# QDRANT_API_KEY=your-qdrant-api-key-here

# ──────────────────────────────────────────────────────────────────────────────
# MAX_UPLOAD_SIZE_MB - File Upload Size Limit
# ──────────────────────────────────────────────────────────────────────────────
# What it does:
#   - Limits the maximum size of uploaded documents
#   - Prevents server overload from very large files
#   - Default: 100MB (sufficient for most documents)
#
# MAX_UPLOAD_SIZE_MB=100

# ──────────────────────────────────────────────────────────────────────────────
# ALLOWED_ORIGINS - Protects Against Unauthorized API Access
# ──────────────────────────────────────────────────────────────────────────────
# What it does:
#   - Controls which domains can make requests to your API (CORS protection)
#   - Prevents malicious websites from accessing your system
#   - Blocks CSRF (Cross-Site Request Forgery) attacks
#
# How to set it:
#   - List the domains that should be allowed to access the API
#   - Use comma-separated list for multiple domains (no spaces!)
#   - Must match the domain users access in their browser
#
# Examples:
#
# Single domain (production with HTTPS):
# ALLOWED_ORIGINS=https://rag.yourdomain.com
#
# Multiple domains (www + non-www):
# ALLOWED_ORIGINS=https://rag.yourdomain.com,https://www.rag.yourdomain.com
#
# Development (localhost only):
# ALLOWED_ORIGINS=http://localhost:3000
#
# LAN + Localhost:
# ALLOWED_ORIGINS=http://localhost:3000,http://192.168.1.165:3000

# ==============================================================================
# CONFIGURATION EXAMPLES
# ==============================================================================

# ──────────────────────────────────────────────────────────────────────────────
# Example 1: Local Development (No Security Needed)
# ──────────────────────────────────────────────────────────────────────────────
# VITE_API_URL=http://localhost:8000
# BACKEND_PORT=8000
# FRONTEND_PORT=3000
#
# Security: Not configured (uses insecure defaults - OK for local testing)

# ──────────────────────────────────────────────────────────────────────────────
# Example 2: LAN Access (Basic Security)
# ──────────────────────────────────────────────────────────────────────────────
# VITE_API_URL=http://192.168.1.100:8000
# BACKEND_PORT=8000
# FRONTEND_PORT=3000
# JWT_SECRET_KEY=<generate-with-openssl-rand-hex-32>
# ALLOWED_ORIGINS=http://192.168.1.100:3000,http://localhost:3000

# ──────────────────────────────────────────────────────────────────────────────
# Example 3: Production with Domain & HTTPS (Full Security)
# ──────────────────────────────────────────────────────────────────────────────
# VITE_API_URL=https://rag.yourdomain.com
# BACKEND_PORT=8000
# FRONTEND_PORT=3000
# JWT_SECRET_KEY=<generate-with-openssl-rand-hex-32>
# ALLOWED_ORIGINS=https://rag.yourdomain.com
#
# Reverse Proxy Setup (Nginx/Caddy):
#   - Frontend: https://rag.yourdomain.com → http://server-ip:3000
#   - Backend:  https://rag.yourdomain.com → http://server-ip:8000
#   - SSL certificate (Let's Encrypt recommended)

# ==============================================================================
# STEP-BY-STEP SETUP GUIDE
# ==============================================================================
#
# 1. COPY THIS FILE
#    cp .env.example .env
#
# 2. CHOOSE YOUR SCENARIO
#    Uncomment the appropriate VITE_API_URL line above
#
# 3. GENERATE JWT SECRET (Production/LAN only)
#    openssl rand -hex 32
#    Copy the output
#
# 4. CONFIGURE SECURITY (Production/LAN only)
#    Edit .env and add:
#      JWT_SECRET_KEY=<paste-generated-key>
#      ALLOWED_ORIGINS=<your-domain-or-ip>
#
# 5. RESTART BACKEND
#    docker compose down
#    docker compose up -d
#
# 6. VERIFY SECURITY IS ACTIVE
#    docker compose logs backend | grep -E "JWT|CORS"
#
#    You should see:
#      ✓ JWT_SECRET_KEY loaded from environment
#      CORS: Restricted to specific origins: ['https://yourdomain.com']
#
#    If you see warnings:
#      ⚠️ JWT_SECRET_KEY not set - using insecure default key!
#      CORS: ALLOWED_ORIGINS not set - allowing all origins (*)
#    → Security is NOT active - check your .env file
#
# ==============================================================================
# TROUBLESHOOTING
# ==============================================================================
#
# Q: I configured .env but backend still shows warnings
# A: Run `docker compose down` then `docker compose up -d`
#    (restart is not enough - must recreate containers)
#
# Q: Frontend shows CORS errors
# A: Make sure ALLOWED_ORIGINS matches the URL in your browser
#    Example: If accessing https://rag.example.com, use:
#    ALLOWED_ORIGINS=https://rag.example.com
#
# Q: Can I use IP address in ALLOWED_ORIGINS?
# A: Yes, but match exactly what's in the browser address bar:
#    http://192.168.1.100:3000 (with port if accessing frontend with port)
#    http://192.168.1.100 (without port if using reverse proxy)
#
# Q: Do I need security for local testing?
# A: No - if only accessing from localhost, you can skip JWT_SECRET_KEY
#    and ALLOWED_ORIGINS (but set them before going to production!)
#
# ==============================================================================
